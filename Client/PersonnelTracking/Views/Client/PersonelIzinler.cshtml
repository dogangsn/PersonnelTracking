@model IEnumerable<PersonnelTracking.App_Data.KayitliPersonel>
@{
    ViewBag.Title = "PersonelIzinler";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<main>
    <style>
         .avatar-pic {
            width: 150px;
            height : 150px;
        }
        .table-wrapper-2 {
            display: block;
            max-height: 500px;
            overflow-y: auto;
            -ms-overflow-style: -ms-autohiding-scrollbar;
        }

        .scrollbar {
            margin-left: 30px;
            float: left;
            height: 300px;
            width: 65px;
            background: #fff;
            overflow-y: scroll;
            margin-bottom: 25px;
        }

        .scrollbar-primary::-webkit-scrollbar {
            width: 12px;
            background-color: #F5F5F5;
        }

        .scrollbar-primary::-webkit-scrollbar-thumb {
            border-radius: 10px;
            -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.1);
            background-color: #4285F4;
        }
    </style>
    <style>
        ul.striped li {
            padding: .5rem;
            border-bottom: 1px solid rgba(0,0,0,.15);
        }

        .section-preview {
            border: 1px solid #e0e0e0;
            padding: 15px;
        }

        .steps-form {
            display: table;
            width: 100%;
            position: relative;
        }

            .steps-form .steps-row {
                display: table-row;
            }

                .steps-form .steps-row:before {
                    top: 14px;
                    bottom: 0;
                    position: absolute;
                    content: " ";
                    width: 100%;
                    height: 1px;
                    background-color: #ccc;
                }

                .steps-form .steps-row .steps-step {
                    display: table-cell;
                    text-align: center;
                    position: relative;
                }

                    .steps-form .steps-row .steps-step p {
                        margin-top: 0.5rem;
                    }

                    .steps-form .steps-row .steps-step button[disabled] {
                        opacity: 1 !important;
                        filter: alpha(opacity=100) !important;
                    }

                    .steps-form .steps-row .steps-step .btn-circle {
                        width: 30px;
                        height: 30px;
                        text-align: center;
                        padding: 6px 0;
                        font-size: 12px;
                        line-height: 1.428571429;
                        border-radius: 15px;
                        margin-top: 0;
                    }
    </style>
    <h2>Personel Izinleri</h2>
    <br /> <br />
    <div class="row">
        <div class="col-md-8 col-lg-7 col-xl-7">
            <div class="md-form" style="width: 600px">
                <select class="mdb-select" id="personel">
                    <option value="" disabled selected></option>
                    @foreach (var item in Model.Where(s => s.Silindi == false || s.Silindi == null))
                    {
                        <option value="@item.KId" data-icon="../Content/PersonelFoto/@item.FotoYol" class="rounded-circle">@item.PAdSoyad</option>
                    }
                </select>
                <label>Personel Seçiniz ...</label>
            </div>
            <br />
            <div style="display:none" id="Icerik">
                <section class="section-preview">
                    <div class="row">
                        <div class="col-md-4 mb-4">
                            <div class="form-check">
                                <input type="radio" class="form-check-input" id="izin1" name="groupOfMaterialRadios" value="YILLIK İZİN">
                                <label class="form-check-label" for="izin1">Yıllık İzin</label>
                            </div>
                            <div class="form-check">
                                <input type="radio" class="form-check-input" id="izin2" name="groupOfMaterialRadios" value="SAĞLIK RAPORU">
                                <label class="form-check-label" for="izin2">Sağlık Raporu</label>
                            </div>
                            <div class="form-check">
                                <input type="radio" class="form-check-input" id="izin3" name="groupOfMaterialRadios" value="MAZARET İZNİ">
                                <label class="form-check-label" for="izin3">Mazeret İzni</label>
                            </div>
                            <div class="form-check">
                                <input type="radio" class="form-check-input" id="izin4" name="groupOfMaterialRadios" value="RESMİ TATİL İZNİ">
                                <label class="form-check-label" for="izin4">Resmi Tatil İzni</label>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="form-check ">
                                <input type="radio" class="form-check-input" id="izin5" name="groupOfMaterialRadios" value="DOĞUM İZNİ">
                                <label class="form-check-label" for="izin5">Doğum İzni</label>
                            </div>
                            <div class="form-check ">
                                <input type="radio" class="form-check-input" id="izin6" name="groupOfMaterialRadios" value="BABALIK İZNİ">
                                <label class="form-check-label" for="izin6">Babalık İzni</label>
                            </div>
                            <div class="form-check ">
                                <input type="radio" class="form-check-input" id="izin7" name="groupOfMaterialRadios" value="ÖLÜM İZNİ">
                                <label class="form-check-label" for="izin7">Ölüm İzni</label>
                            </div>
                            <div class="form-check ">
                                <input type="radio" class="form-check-input" id="izin8" name="groupOfMaterialRadios" value="NÖBET İZNİ">
                                <label class="form-check-label" for="izin8">Nöbet İzni</label>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="form-check ">
                                <input type="radio" class="form-check-input" id="izin9" name="groupOfMaterialRadios" value="ÜCRETSİZ İZİN">
                                <label class="form-check-label" for="izin9">Ücretsiz İzin</label>
                            </div>
                        </div>
                    </div>
                </section>
                <br /><br />
                <div class="card">
                    <br />
                    <div class="card-body mb-4">
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="md-form">
                                    <input placeholder="@DateTime.Now.ToShortDateString()" type="text" id="startingDate" data-date-format="DD MMM YYYY" class="form-control datepicker" data-value="2018/06/04">
                                    <label for="startingDate">Başlangıç Tarihi</label>
                                </div>
                            </div>
                            <div class="col-md-6 mb-4">
                                <div class="md-form">
                                    <input placeholder="@DateTime.Now.ToShortDateString()" type="text" id="endingDate" data-date-format="DD MMM YYYY" class="form-control datepicker" data-value="2018/06/04">
                                    <label for="endingDate">Bitiş Tarihi</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="md-form">
                                    <input placeholder="" type="text" id="BaslangicSaati" class="form-control timepicker" value="08:00">
                                    <label for="BaslangicSaati">İzne Çıkış Saati</label>
                                </div>
                            </div>
                            <div class="col-md-6 mb-4">
                                <div class="md-form">
                                    <input placeholder="" type="text" id="BitisSaati" class="form-control timepicker" value="18:00">
                                    <label for="BitisSaati">İzni Bitiş Saati</label>
                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="md-form">
                            <i class="fa fa-pencil prefix"></i>
                            <textarea type="text" id="aciklama" class="md-textarea form-control" rows="3"></textarea>
                            <label for="form10">Açıklama Giriniz</label>
                        </div>
                        <button class="btn btn-success float-right" id="Kaydet"><i class="fa fa-check" aria-hidden="true"></i> KAYDET</button>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-1">
            <div id="KisiBilgileri" style="display:none">
                <div class="card profile-card">
                    <div class="avatar z-depth-1-half mb-4" style="max-width: 150px; max-height: 150px; margin: -70px auto 0; -webkit-border-radius: 50%; border-radius: 50%; overflow: hidden;" id="BilgiImage">
                        <img src="https://mdbootstrap.com/img/Photos/Others/placeholder-avatar.jpg" class="rounded-circle avatar-pic" alt="First sample avatar image">
                    </div>
                    <div class="card-body pt-0 mt-0">
                        <div class="text-center" id="adsoyad">
                            <h3 class="mb-3 font-weight-bold"><span>....</span></h3>
                        </div>

                        <ul class="striped list-unstyled" id="PrsKimlik">
                            <li><strong>E-mail address:</strong>-</li>
                            <li><strong>Phone number:</strong>-</li>
                            <li><strong>Doğum Tarihi:</strong>-</li>
                            <li><strong>Adres:</strong>-</li>
                            <li><strong>Ise Başlama Tarihi:</strong>-</li>
                        </ul>
                    </div>
                    <div class="card-body" style="text-align: center;bottom: 25px;">
                        <button type="button" class="btn btn-info btn-rounded btn-md" data-toggle="modal" data-target="#İzinDetaylar" id="IzinDetay">Izin Detayları</button>
                    </div>
                </div>
            </div>
            <br />
            <div id="IzınBilgileri" style="display:none">
                <div class="card profile-card">
                    <div class="card-body pt-0 mt-0">
                        <div class="text-center">
                            <h3>Izin Bilgileri</h3>
                            <hr />
                        </div>
                        <div class="card-body">
                            <ul class="striped list-unstyled" id="PrsKimlik">
                                <li><strong>Yıllık İzin Hakkı:</strong>-</li>
                                <li><strong>Resmi Tatil Hakkı:</strong>-</li>
                                <li><strong>Kullanıdığı Izin:</strong>-</li>
                            </ul>
                        </div>

                    </div>
                </div>
            </div>
        </div>



    </div>
    <!--  Modal  -->
    <div class="modal fade" id="İzinDetaylar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title w-100" id="ModalBaslik"></h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="table-wrapper-2 scrollbar-primary">
                        <!--Table-->
                        <table class="table table-hover table-fixed table-responsive-md mb-0" id="İzinler">
                            <!--Table head-->
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Izin Turu</th>
                                    <th>İzne Çıkış Zamanı</th>
                                    <th>İzin Bitiş Zamanı</th>
                                    <th>Açıklama</th>
                                    @*@if (Session["uyeTuru"].ToString() == "1")
                                        {*@
                                    <th>Delete/Update</th>
                                    @* } *@
                                </tr>
                            </thead>
                            <!--Table head-->
                            <!--Table body-->
                            <tbody>
                                <tr>
                                    <th>#</th>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    @*@if (Session["uyeTuru"].ToString() == "1")
                                        {*@
                                    <td></td>
                                    @* } *@
                                </tr>

                            </tbody>
                            <!--Table body-->

                        </table>
                        <!--Table-->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!--  Modal  -->
    <!--Modal: modalConfirmDelete-->
    <div class="modal fade" id="silModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-notify modal-danger" role="document">
            <!--Content-->
            <div class="modal-content text-center">
                <!--Header-->
                <div class="modal-header d-flex justify-content-center">
                    <p class="heading">Emin misiniz?</p>
                </div>

                <!--Body-->
                <div class="modal-body">
                    <i class="fa fa-times fa-4x animated rotateIn"></i>
                    <input type="hidden" id="silId" />
                </div>
                <!--Footer-->
                <div class="modal-footer flex-center">
                    <a type="button" class="btn btn-danger" id="btnSil">Kaydı Sil</a>
                    <a type="button" class="btn btn-outline-danger waves-effect" data-dismiss="modal">Close</a>
                </div>
            </div>
            <!--/.Content-->
        </div>
    </div>
    <!--Modal: modalConfirmDelete-->


    <div class="modal fade right" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-full-height modal-right" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title w-100" id="UpdateModalBaslik"></h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="card">
                        <br />
                        <div class="card-body mb-4">
                            <input type="hidden" id="id" class="form-control">
                            <select class="mdb-select" id="IzinTuru" name="IzinTuru">
                                <option value="YILLIK İZİN" @(ViewBag.Secim == "YILLIK İZİN" ? "Selected" : "")>YILLIK İZİN</option>
                                <option value="SAĞLIK RAPORU" @(ViewBag.Secim == "SAĞLIK RAPORU" ? "Selected" : "")>SAĞLIK RAPORU</option>
                                <option value="MAZARET İZNİ" @(ViewBag.Secim == "MAZARET İZNİ" ? "Selected" : "")>MAZARET İZNİ</option>
                                <option value="RESMİ TATİL İZNİ" @(ViewBag.Secim == "RESMİ TATİL İZNİ" ? "Selected" : "")>RESMİ TATİL İZNİ</option>
                                <option value="DOĞUM İZNİ" @(ViewBag.Secim == "DOĞUM İZNİ" ? "Selected" : "")>DOĞUM İZNİ</option>
                                <option value="BABALIK İZNİ" @(ViewBag.Secim == "BABALIK İZNİ" ? "Selected" : "")>BABALIK İZNİ</option>
                                <option value="ÖLÜM İZNİ" @(ViewBag.Secim == "ÖLÜM İZNİ" ? "Selected" : "")>ÖLÜM İZNİ</option>
                                <option value="NÖBET İZNİ" @(ViewBag.Secim == "NÖBET İZNİ" ? "Selected" : "")>NÖBET İZNİ</option>
                                <option value="ÜCRETSİZ İZİN" @(ViewBag.Secim == "ÜCRETSİZ İZİN" ? "Selected" : "")>ÜCRETSİZ İZİN</option>
                                <option value="ŞEHİR DIŞI - MÜŞTERİ" @(ViewBag.Secim == "ÜCRETSİZ İZİN" ? "Selected" : "")>ŞEHİR DIŞI - MÜŞTERİ</option>
                            </select>
                            <label>Izin Türü Seçiniz ...</label>
                            <br /><br />
                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    <div class="md-form">
                                        <input placeholder="" type="text" id="updatestartingDate" data-date-format="DD MMM YYYY" class="form-control datepicker" data-value="2018/06/04">
                                        <label for="updatestartingDate">Başlangıç Tarihi</label>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-4">
                                    <div class="md-form">
                                        <input placeholder="" type="text" id="updateendingDate" data-date-format="DD MMM YYYY" class="form-control datepicker" data-value="2018/06/04">
                                        <label for="updateendingDate">Bitiş Tarihi</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-4">

                                    <div class="md-form">
                                        <input placeholder="" type="text" id="UpdateBaslangicSaati" class="form-control timepicker" value="">
                                        <label for="UpdateBaslangicSaati">İzne Çıkış Saati</label>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-4">

                                    <div class="md-form">
                                        <input placeholder="" type="text" id="updateBitisSaati" class="form-control timepicker" value="">
                                        <label for="updateBitisSaati">İzni Bitiş Saati</label>
                                    </div>
                                </div>
                            </div>
                            <br />
                            <div class="md-form">
                                <i class="fa fa-pencil prefix"></i>
                                <textarea type="text" id="Updateaciklama" class="md-textarea form-control" rows="3"></textarea>
                                <label for="form10">Açıklama Giriniz</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="UpdateSave">Update</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        var search_id = 0;
        var adsoyad;
        $(document).ready(function () {
            $('.mdb-select').material_select();

            $('#BaslangicSaati').pickatime({
                twelvehour: false,
                darktheme: true
            });
            $('#BitisSaati').pickatime({
                twelvehour: false,
                darktheme: true
            });
            $('#UpdateBaslangicSaati').pickatime({
                twelvehour: false,
                darktheme: true
            });
            $('#updateBitisSaati').pickatime({
                twelvehour: false,
                darktheme: true
            });

            $('.datepicker').pickadate({
                monthsFull: ['Ocak', 'Şubat', 'Mart', 'Nisan', 'Mayıs', 'Haziran', 'Temmmuz', 'Ağustos', 'Eylül', 'Ekim', 'Kasım', 'Aralık'],
                monthsShort: ['Oca', 'Şub', 'Mar', 'Nis', 'May', 'Haz', 'Tem', 'Aug', 'Eyl', 'Eki', 'Kas', 'Ara'],
                weekdaysFull: ['Pazar', 'Pazartesi', 'Salı', 'Çarşamba', 'Perşembe', 'Cuma', 'Cumartesi'],
                weekdaysShort: ['Pzr', 'Pzt', 'Sal', 'Car', 'Per', 'Cum', 'Cmt'],
                today: 'Bugün',
                clear: 'Temizle',
                close: 'Kapat',
                labelMonthNext: 'Sonraki Ay',
                labelMonthPrev: 'Önceki Ay',
                labelMonthSelect: 'Ay Seçiniz',
                labelYearSelect: 'Yıl Seçiniz',
                format: 'dd.mm.yyyy',

            });
            //---------

            $("#personel").change(function () {

                search_id = $(this).val();
                $("#Icerik").show();
                $("#KisiBilgileri").show();
                $("#IzınBilgileri").show();
                //for (var i = 1; i <= 4; i++) {
                //    document.getElementById("izin" + i).checked = false;
                //}
                console.log(search_id);
                $.ajax({
                    type: "GET",
                    url: "./PersonelIzinBilgi?KayitId=" + search_id,
                    dataType: "json",
                    success: function (data) {
                        //for (var i = 1; i <= 4; i++) {
                        //    document.getElementById("izin" + i).checked = true;
                        //}
                        //item.BaslangicTarihi.substring(8, 10) + "." + item.BaslangicTarihi.substring(5, 7) + "." + item.BaslangicTarihi.substring(0, 4)
                        var list = $('#BilgiImage');
                        list.find('img').remove();
                        var obj = JSON.parse(data);
                        var Formatdogumtarihi = obj.DogumTarihi.substring(8, 10) + "." + obj.DogumTarihi.substring(5, 7) + "." + obj.DogumTarihi.substring(0, 4);
                        var FormatIseBaslama = obj.IseBaslamaTarihi.substring(8, 10) + "." + obj.IseBaslamaTarihi.substring(5, 7) + "." + obj.IseBaslamaTarihi.substring(0, 4);
                        console.log(obj);
                        adsoyad = obj.PAdSoyad;
                        var Eposta = obj.EPosta;
                        var CepNum = obj.CepNum;
                        var DogumTarihi = Formatdogumtarihi;
                        var adres = obj.Adres;
                        var FotoPath = obj.FotoYol;
                        var IseBaslama = FormatIseBaslama;
                        $.each(obj, function (i, item) {
                            document.getElementById("adsoyad").innerHTML = '<h3 class="mb-3 font-weight-bold">' + adsoyad + '</h3>';
                            document.getElementById("PrsKimlik").innerHTML = '<li><strong>E-mail address:</strong> ' + Eposta + '</li>' + '<li><strong>Phone number:</strong> ' + CepNum + '</li>' + ' <li><strong>Doğum Tarihi:</strong> ' + DogumTarihi + '</li>' + '<li><strong>Adres:</strong> ' + adres + '</li>' + '<li><strong>Ise Başlama Tarihi:</strong> ' + IseBaslama + '</li>';
                        });
                        if (FotoPath != null) {
                            $("#BilgiImage").append('<img src="../Content/PersonelFoto/' + FotoPath + '" class="rounded-circle" style="width:150px; height:150px;"/>');
                        } else {
                            $("#BilgiImage").append('<img src="https://mdbootstrap.com/img/Photos/Others/placeholder-avatar.jpg" class="rounded-circle avatar-pic" alt="First sample avatar image" />');
                        }
                    }
                })
            });
            //-----------

            //--------IzınSave-------
            $("#Kaydet").click(function () {
                // var check = document.getElementsByName('groupOfMaterialRadios');
                var IzinTuru = $("input:radio[name=groupOfMaterialRadios]:checked").val()
                let BaslangicTarihi = $('#startingDate').val();
                let BitisTarihi = $('#endingDate').val();
                let BaslangicSati = $('#BaslangicSaati').val();
                let BitisSaati = $('#BitisSaati').val();
                console.log(BaslangicTarihi + " " + BaslangicSati + ":00");
                if (IzinTuru != null && BaslangicSati < BitisSaati && BaslangicTarihi <= BitisTarihi) {
                    //var IzinTuru = $("input:radio[name=groupOfMaterialRadios]:checked").val()
                    console.log(IzinTuru);
                    var data = {
                        KId: search_id,
                        IzinTuru: IzinTuru,
                        BaslangicTarihi: BaslangicTarihi + " " + BaslangicSati + ":00",
                        BitisTarihi: BitisTarihi + " " + BitisSaati + ":00",
                        Aciklama: $("#aciklama").val()
                    }
                    $.ajax({
                        type: "POST",
                        url: "./IzinKaydet",
                        data: data,
                        success: function (result) {
                            toastr["success"]("Notunuz Kaydedildi...");
                            window.location.href = "./PersonelIzinler";
                        }
                    })
                }
                else {
                    toastr["error"]("Er:Alanları Kontrol Ediniz...");

                }
            });
            //--------------
        });
        //İzinListeleme İzinler

        $('#IzinDetay').click(function () {
            $("#ModalBaslik").html(adsoyad);
            $.ajax({
                type: "GET",
                url: "./IzinListesi?kaytId=" + search_id,
                dataType: "json",
                success: function (data) {
                    var obj = JSON.parse(data);
                    console.log(obj);
                    var list = $('#İzinler');
                    list.find('tbody tr').remove();
                    list.find('tbody td').remove();
                    list.find('div').remove();
                    var rows;
                    $.each(obj, function (i, item) {

                        rows += "<tr>" +
                  "<td>" + item.id + "</td>" +
                  "<td>" + item.IzinTuru + "</td>" +
                  "<td>" + item.BaslangicTarihi + "</td>" +
                  "<td>" + item.BitisTarihi + "</td>" +
                  "<td>" + item.Aciklama + "</td>" +
                  "<td>" + "<a class='btn-floating btn-sm' onclick = 'IzınUpdate(" + item.id + ")'><i class='fa fa-edit' aria-hidden='true'></i></a>   <a class='btn-floating btn-sm'  onclick = 'IzinDelete(" + item.id + ")'><i class='fa fa-close' aria-hidden='true'></i></a>" + "</td>"
                        "</tr>";

                    });
                    $('#İzinler tbody').html(rows);
                }
            });

        })

        //-----------
        //$(document).on("click", ".sil", function () {
        //    var satir = $(this).closest("tr");
        //    satir.remove();
        //});

        function IzinDelete(izinid) {
            console.log(izinid);
            $("#silId").val(izinid);
            $("#silModal").modal();

        }
        $("#btnSil").click(function () {
            var id = $("#silId").val();
            $.ajax({
                type: "POST",
                url: "./IzinDelete?id=" + id,
                success: function (data) {
                    // window.location.href = "/KodYazilim/PersonelListe";
                    $("#silModal").modal("hide");
                    window.location.href = "./PersonelIzinler";
                    toastr["success"]("Kayıt Silindi...");
                }
            });
        });


        function IzınUpdate(izinId) {
            $("#updateModal").modal();
            $("#id").val(izinId);
            $("#UpdateModalBaslik").html(adsoyad + "- Edit");
            $.ajax({
                type: "GET",
                url: "IzinUpdateList?id=" + izinId,
                success: function (data) {
                    // IzinTurleri();
                    var obj = JSON.parse(data);
                    $("#Updateaciklama").trigger("focusin");
                    $("#Updateaciklama").val(obj.Aciklama);

                    var IzınTuru = obj.IzinTuru;
                    let EditBaslangic = obj.BaslangicTarihi.split('T')[0];
                    let EditBitis = obj.BitisTarihi.split('T')[0];
                    let EditBasblangicSaati = obj.BaslangicTarihi.split('T')[1];
                    let EditBitisSaati = obj.BitisTarihi.split('T')[1];

                    let FormatBaslangicT = obj.BaslangicTarihi.substring(8, 10) + "." + obj.BaslangicTarihi.substring(5, 7) + "." + obj.BaslangicTarihi.substring(0, 4)
                    let formatBitisT = obj.BitisTarihi.substring(8, 10) + "." + obj.BitisTarihi.substring(5, 7) + "." + obj.BitisTarihi.substring(0, 4)

                    let formatBaslangicS = EditBasblangicSaati.substring(0, 5);
                    let FormatBitisS = EditBitisSaati.substring(0, 5);
                    console.log(formatBaslangicS);

                    $("#updatestartingDate").val(FormatBaslangicT);
                    $("#updateendingDate").val(formatBitisT);
                    $("#UpdateBaslangicSaati").trigger("focusin");
                    $("#UpdateBaslangicSaati").val(formatBaslangicS);
                    $("#updateBitisSaati").trigger("focusin");
                    $("#updateBitisSaati").val(FormatBitisS);

                }

            })
        }


        function IzinTurleri() {
            $.ajax({
                type: "GET",
                url: "./IzinTuruList",
                success: function (data) {

                    var list = $('#IzinTuru');
                    list.find('option').remove();
                    var IzinData = JSON.parse(data);
                    console.log(data);
                    $.each(IzinData, function (i, item) {
                        list.append('<option value="' + item.Value + '">' + item.Name + '</option>');
                    });
                }

            });

        }


        $('#UpdateSave').click(function () {
            var NotId = $("#id").val();

            let UBaslangicTarihi = $('#updatestartingDate').val();
            let UBitisTarihi = $('#UpdateBaslangicSaati').val();

            let UBaslangicSati = $('#updateendingDate').val();
            let UBitisSaati = $('#updateBitisSaati').val();



            var data = {
                IzinTuru: $('#IzinTuru').val(),
                BaslangicTarihi: UBaslangicTarihi + " " + UBitisTarihi + ":00",
                BitisTarihi: UBaslangicSati + " " + UBitisSaati + ":00",
                Aciklama: $('#Updateaciklama').val()
            }
            console.log(data);
            $.ajax({
                type: "POST",
                url: "./IzinUpdate?NotId=" + NotId,
                data: data,
                success: function (result) {
                    toastr["success"]("Kayıt Guncellendi...")
                    $("#updateModal").modal("hide");
                    $("#İzinDetaylar").modal("hide");

                }
            })
        })
        
        
       

    </script>
</main>
